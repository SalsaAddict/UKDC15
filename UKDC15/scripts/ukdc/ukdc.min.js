"use strict";var UKDC,ukdc;(function(n){var t={"Salsa On1":{rgb:"170,255,170"},"Salsa On2":{rgb:"68,170,255"}},r,i,u;(function(n){var r=function(){function n(n,r,u){var f=this;this.$scope=n;this.$window=r;this.$modal=u;this.$currentDate=undefined;this.isCurrentDate=function(n){return f.$currentDate===n};this.setCurrentDate=function(n){f.$currentDate=n};this.$datepicker=!1;this.datepicker=function(n){n.preventDefault();n.stopPropagation();f.$datepicker=!0};this.save=function(){f.$window.localStorage.setItem("timetable",angular.toJson(f.$scope.timetable))};this.addDate=function(n){n.preventDefault();n.stopPropagation();var t={date:null,rooms:[],times:[]};f.$scope.timetable.dates.push(t);f.setCurrentDate(t)};this.removeDate=function(n){var t=f.$scope.timetable.dates.indexOf(n);t>=0&&f.$scope.timetable.dates.splice(t,1)};this.addRoom=function(n,t){t.preventDefault();t.stopPropagation();var i=n.rooms.length+1;n.rooms.push({name:"Room "+String(i)});angular.forEach(n.times,function(n){n.slots.push({style:null,split:!1,workshops:[]})})};this.moveRoomLeft=function(n,t,i){var r,u;i.preventDefault();i.stopPropagation();r=n.rooms.indexOf(t);r>=0&&(u=n.rooms[r-1],n.rooms[r-1]=n.rooms[r],n.rooms[r]=u,angular.forEach(n.times,function(n){var t=n.slots[r-1];n.slots[r-1]=n.slots[r];n.slots[r]=t}))};this.removeRoom=function(n,t,i){i.preventDefault();i.stopPropagation();var r=n.rooms.indexOf(t);r>=0&&(n.rooms.splice(r,1),angular.forEach(n.times,function(n){n.slots.splice(r,1)}))};this.addTime=function(n,t){t.preventDefault();t.stopPropagation();var i={time:null,slots:[]};angular.forEach(n.rooms,function(){i.slots.push({style:null,split:!1,workshops:[]})});n.times.push(i)};this.moveTimeUp=function(n,t,i){var r,u;i.preventDefault();i.stopPropagation();r=n.times.indexOf(t);r>=0&&(u=n.times[r-1],n.times[r-1]=n.times[r],n.times[r]=u)};this.removeTime=function(n,t,i){i.preventDefault();i.stopPropagation();var r=n.times.indexOf(t);r>=0&&n.times.splice(r,1)};this.editSlot=function(n,t,r,u){u.preventDefault();u.stopPropagation();var e=f.$modal.open({templateUrl:"templates/slot.html",resolve:{date:function(){return n.date},room:function(){return n.rooms[t.slots.indexOf(r)].name},time:function(){return t.time},slot:function(){return r}},controller:i.Controller,controllerAs:"ctrl"})};this.slotStyle=function(n){if(n.style)return"background-color: rgb("+t[n.style].rgb+");"};this.$scope.timetable=angular.fromJson(this.$window.localStorage.getItem("timetable"))||{dates:[]};this.$scope.timetable.dates.length>0&&this.setCurrentDate(this.$scope.timetable.dates[0])}return n.$inject=["$scope","$window","$modal"],n}();n.Controller=r})(r=n.Build||(n.Build={})),function(n){var i=function(){function n(n,i,r,u,f,e){var o=this;this.$scope=n;this.$modalInstance=i;this.date=r;this.room=u;this.time=f;this.slot=e;this.styles=t;n.$watchCollection(function(){return{style:o.slot.style,split:o.slot.split}},function(n,t){n!==t&&(o.slot.style?(o.slot.workshops.length===0&&o.slot.workshops.push({artist:null,title:null,level:null}),o.slot.split?o.slot.workshops.length===1&&o.slot.workshops.push({artist:null,title:null,level:null}):o.slot.workshops.length>1&&o.slot.workshops.splice(1),o.slot.workshops.length>2&&o.slot.workshops.splice(2)):(o.slot.split=!1,o.slot.workshops.length>0&&o.slot.workshops.splice(0)))})}return n.$inject=["$scope","$modalInstance","date","room","time","slot"],n}();n.Controller=i}(i=n.Slot||(n.Slot={})),function(n){var t=function(){function n(n,t,i){var r=this;this.$scope=n;this.$http=t;this.$filter=i;this.$currentDate=undefined;this.isCurrentDate=function(n){return r.$currentDate===n};this.setCurrentDate=function(n){r.$currentDate=n};this.workshopCssStyle=function(n){if(n&&n.Style){var t=r.$filter("filter")(r.$scope.Timetable.Styles,function(t){return t.Name===n.Style})[0],i=n.Level?r.$filter("filter")(r.$scope.Timetable.Levels,function(t){return t.Name===n.Level})[0]:{Opacity:1};return"background-color: rgba("+t.RGB+","+i.Opacity+")"}};this.artists=function(){var n={};return angular.forEach(r.$scope.Timetable.Dates,function(t){angular.forEach(t.Times,function(t){angular.forEach(t.Slots,function(t){angular.forEach(t.Workshops,function(t){angular.isDefined(t.Artist)&&(angular.isDefined(n[t.Artist])||(n[t.Artist]={Total:0}),n[t.Artist].Total++)})})})}),n};this.$scope.Timetable={};this.$http.get("timetable.ashx?EventId=1").success(function(n){r.$scope.Timetable=n})}return n.$inject=["$scope","$http","$filter"],n}();n.Controller=t}(u=n.Timetable||(n.Timetable={}))})(UKDC||(UKDC={}));ukdc=angular.module("ukdc",["ngRoute","ui.bootstrap"]);ukdc.config(["$routeProvider",function(n){n.when("/home",{caseInsensitiveMatch:!0,templateUrl:"views/home.html"}).when("/build",{caseInsensitiveMatch:!0,templateUrl:"views/build.html",controller:UKDC.Build.Controller,controllerAs:"ctrl"}).when("/timetable",{caseInsensitiveMatch:!0,templateUrl:"views/timetable.html",controller:UKDC.Timetable.Controller,controllerAs:"ctrl"}).otherwise({redirectTo:"/home"})}]);
//# sourceMappingURL=ukdc.min.js.map
